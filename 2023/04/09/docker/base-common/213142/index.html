<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png"><link rel="icon" href="/img/fluid.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="EtcFly"><meta name="keywords" content=""><meta name="description" content="版权归作者所有, 转载请保留该部分声明。本文作者：EtcFly原文地址：https:&#x2F;&#x2F;etcfly.top              背景   在linux生产环境中, 经常需要部署各类应用, 这些应用都具有不同的依赖, 这些依赖有时候会相互冲突让部署变得异常繁琐。其次, 当应用被移植部署到不同机器的时候, 还需要频繁安装允许环境，大大降低了部署效率。那有没有一种手段能"><meta property="og:type" content="article"><meta property="og:title" content="Docker容器基础"><meta property="og:url" content="http://example.com/2023/04/09/docker/base-common/213142/"><meta property="og:site_name" content="仗剑走天涯"><meta property="og:description" content="版权归作者所有, 转载请保留该部分声明。本文作者：EtcFly原文地址：https:&#x2F;&#x2F;etcfly.top              背景   在linux生产环境中, 经常需要部署各类应用, 这些应用都具有不同的依赖, 这些依赖有时候会相互冲突让部署变得异常繁琐。其次, 当应用被移植部署到不同机器的时候, 还需要频繁安装允许环境，大大降低了部署效率。那有没有一种手段能"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/docker.png"><meta property="article:published_time" content="2023-04-09T19:22:32.000Z"><meta property="article:modified_time" content="2024-03-05T03:41:04.000Z"><meta property="article:author" content="EtcFly"><meta property="article:tag" content="原创"><meta property="article:tag" content="docker"><meta property="article:tag" content="容器"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="http://example.com/img/docker.png"><title>Docker容器基础 仗剑走天涯</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/fluid-extention.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"example.com",root:"/",version:"1.9.2",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!0,offset_factor:4},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"3AEufnWAJdp8cFODp1DXvrQU-MdYXbMMI",app_key:"mGJiL6xVvYv21ygqfynJoCyO",server_url:null,path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Strive For Dream</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="Docker容器基础"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-04-09 19:22" pubdate>2023年4月9日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 27k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 229 分钟 </span><span id="vvdpost_container_page_pvuv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="vvdpost_value_page_pv">0</span> 次&nbsp&nbsp <i class="iconfont icon-users" aria-hidden="true"></i> <span id="vvdpost_value_page_uv">0</span> 人</span><script>console.log(window.location.pathname);var httpRequest=new XMLHttpRequest;httpRequest.open("POST","https://etcfly.top:14200/poststats",!0),httpRequest.setRequestHeader("Content-type","application/json"),httpRequest.send(JSON.stringify(window.location.pathname)),httpRequest.onreadystatechange=function(){if(4==httpRequest.readyState&&200==httpRequest.status){var e=httpRequest.responseText,t=JSON.parse(e);console.log(t.pv);var o=document.querySelector("#vvdpost_container_page_pvuv");if(console.log(o),o){var n=document.querySelector("#vvdpost_value_page_pv");console.log(n);var s=document.querySelector("#vvdpost_value_page_uv");console.log(s),s&&s&&(n.innerText=t.pv,s.innerText=t.uv,o.style.display="inline")}}}</script></div></div></div></div></div></div><script async src="https://etcfly.top:14100/script.js" data-website-id="1a5c096d-21e5-4556-99b0-28c810c9c868"></script></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">Docker容器基础</h1><p class="note note-info">本文最后更新于：2024年3月5日 凌晨</p><div class="markdown-body"><div class="note note-success"><p>版权归作者所有, 转载请保留该部分声明。<br>本文作者：EtcFly<br>原文地址：<a target="_blank" rel="noopener" href="https://etcfly.top">https://etcfly.top</a></p></div><hr><h3 id="背景"><a class="markdownIt-Anchor" href="#背景"></a> 背景</h3><p>  在<code>linux</code>生产环境中, 经常需要部署各类应用, 这些应用都具有不同的依赖, 这些依赖有时候会相互冲突让部署变得异常繁琐。其次, 当应用被移植部署到不同机器的时候, 还需要频繁安装允许环境，大大降低了部署效率。那有没有一种手段能解决呢？有，那就是虚拟化。</p><p>  <code>Docker</code>是一个开源的应用容器引擎，它让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到安装了任何 <code>Linux</code> 发行版本的机器上。<code>Docker</code>基于<code>LXC</code>来实现类似<code>VM</code>的功能，可以在更有限的硬件资源上提供给用户更多的计算资源。与同<code>VM</code>等虚拟化的方式不同，<code>LXC</code>不属于全虚拟化、部分虚拟化或半虚拟化中的任何一个分类，而是一个操作系统级虚拟化。</p><p>  <code>Docker</code>是直接运行在宿主操作系统之上的一个容器，使用沙箱机制完全虚拟出一个完整的操作，容器之间不会有任何接口，从而让容器与宿主机之间、容器与容器之间隔离的更加彻底。每个容器会有自己的权限管理，独立的网络与存储栈，及自己的资源管理能，使同一台宿主机上可以友好的共存多个容器。</p><hr><h3 id="差异"><a class="markdownIt-Anchor" href="#差异"></a> 差异</h3><p>和传统的虚拟相比, <code>docker</code>也有所差异, 主要表现在。</p><ul><li><code>Docker</code>容器提供了基于进程的隔离, <code>VM</code>虚拟机提供了资源的完全隔离</li><li><code>docker</code>使用宿主操作系统的内核，而<code>vm</code>虚拟机使用独立的内核</li><li><code>Docker</code>的启动速度是秒级的，<code>vm</code>是分钟级的</li><li><code>Docker的集成性比VM好</code></li></ul><hr><h4 id="机制差异"><a class="markdownIt-Anchor" href="#机制差异"></a> 机制差异</h4><p><img src="/2023/04/09/docker/base-common/213142/docker_vs_vm.png" srcset="/img/loading.gif" lazyload alt="docker_vs_vm.png"></p><ol><li><code>VM(VMware)</code>在宿主机器、宿主机器操作系统的基础上创建虚拟层、虚拟化的操作系统、虚拟化的仓库，然后再安装应用</li><li><code>Container(Docker容器)</code>在宿主机器、宿主机器操作系统上创建 <code>Docker</code> 引擎，在引擎的基础上再安装应用</li><li><code>Docker</code> 容器提供了基于进程的隔离，而<code>VM</code>虚拟机提供了资源的完全隔离。容器使用宿主操作系统的内核，而虚拟机使用独立的内核</li></ol><hr><h4 id="使用差异"><a class="markdownIt-Anchor" href="#使用差异"></a> 使用差异</h4><p><img src="/2023/04/09/docker/base-common/213142/docker_use_diff_vm.png" srcset="/img/loading.gif" lazyload alt="docker_use_diff_vm.png"></p><p><strong>资源差异</strong></p><table><thead><tr><th style="text-align:center">编号</th><th style="text-align:center">虚拟技术</th><th style="text-align:center">硬盘</th><th style="text-align:center">启动速度</th><th style="text-align:center">性能</th><th style="text-align:center">系统支持数</th></tr></thead><tbody><tr><td style="text-align:center"><code>1</code></td><td style="text-align:center"><code>VM</code></td><td style="text-align:center"><code>GB</code>级</td><td style="text-align:center">分钟级</td><td style="text-align:center">弱于</td><td style="text-align:center">一般几十个</td></tr><tr><td style="text-align:center"><code>2</code></td><td style="text-align:center"><code>Docker</code></td><td style="text-align:center"><code>MB</code>级</td><td style="text-align:center">秒级</td><td style="text-align:center">接近原生</td><td style="text-align:center">单机支持上千个容器</td></tr></tbody></table><p><code>Docker</code>在宿主机器的操作系统上创建<code>Docker</code>引擎，直接在宿主主机的操作系统上调用硬件资源，而不是虚拟化操作系统和硬件资源，所以操作速度快。于此同时<code>Docker</code>的集成性更好, 因此广泛用于企业级应用的部署和安装。</p><hr><h4 id="使用特点"><a class="markdownIt-Anchor" href="#使用特点"></a> 使用特点</h4><ol><li>上手快</li></ol><blockquote><p>  用户只需要几分钟，就可以把自己的程序 “<code>Docker</code>化” 。<code>Docker</code> 依赖于 “写时复制” (<code>copy-on-write</code>)模型，使修改应用程序也非常迅速，可以说达到“随心所致，代码即改” 的境界。<br>  随后，就可以创建容器来运行应用程序了。大多数 <code>Docker</code> 容器只需要不到 <code>1</code> 秒中即可启动。由于去除了管理程序的开销，<code>Docker</code> 容器拥有很高的性能，同时同一台宿主机中也 可以运行更多的容器，使用户尽可能的充分利用系统资源。</p></blockquote><ol start="2"><li>职责的逻辑分类</li></ol><blockquote><p>  使用 <code>Docker</code>，开发人员只需要关心容器中运行的应用程序，而运维人员只需要关心如何管理容器。<code>Docker</code> 设计的目的就是要加强开发人员写代码的开发环境与应用程序要部署 的生产环境一致性。从而降低那种“开发时一切正常，肯定是运维的问题(测试环境都是正常的，上线后出了问题就归结为肯定是运维的问题)”</p></blockquote><ol start="3"><li>快速高效的开发生命周期</li></ol><blockquote><p>  <code>Docker</code> 的目标之一就是缩短代码从开发、测试到部署、上线运行的周期，让你的应用 程序具备可移植性，易于构建，并易于协作。(通俗一点说，<code>Docker</code> 就像一个盒子，里面 可以装很多物件，如果需要这些物件的可以直接将该大盒子拿走，而不需要从该盒子中一件件的取。)</p></blockquote><ol start="4"><li>鼓励使用面向服务的架构</li></ol><blockquote><p>  <code>Docker</code> 鼓励面向服务的体系结构和微服务架构。<code>Docker</code> 推荐单个容器只运行一个应 用程序或进程，这样就形成了一个分布式的应用程序模型，在这种模型下，应用程序或者服 务都可以表示为一系列内部互联的容器，从而使分布式部署应用程序，扩展或调试应用程序都变得非常简单，同时也提高了程序的内省性。(当然，可以在一个容器中运行多个应用程序)</p></blockquote><p><strong>参考文档</strong></p><ul><li><a target="_blank" rel="noopener" href="https://www.php.cn/docker/484960.html">vm虚拟机和docker的区别是什么</a></li></ul><hr><h3 id="docker简介"><a class="markdownIt-Anchor" href="#docker简介"></a> docker简介</h3><p>  <code>Docker</code>使用客户端-服务器<code>(C/S)</code> 架构模式, 使用远程<code>API</code>来管理和创建<code>Docker</code>容器, <code>Docker</code> 容器（<code>Container</code>）通过 <code>Docker</code> 镜像（<code>Image</code>）来创建，二者之间的关系类似于面向对象编程中的对象与类。</p><p>如下是<code>Docker</code>基础架构图:</p><p><img src="/2023/04/09/docker/base-common/213142/docker%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%841.png" srcset="/img/loading.gif" lazyload alt="docker基础架构1.png"></p><p><img src="/2023/04/09/docker/base-common/213142/docker%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%842.png" srcset="/img/loading.gif" lazyload alt="docker基础架构2.png"></p><p>  <code>Docker</code>客户端用于向<code>Docker</code>服务器或守护进程发送请求。而服务器或守护进程会接受来自客户的请求（创建、运行、分发容器），并在处理完请求后返回响应结果。<code>Docker</code>提供了一个命令行工具docker，及一整套<code>RESTful API</code>。客户端和服务端既可以运行在一个机器上，也可通过 <code>socket</code> 或者 <code>RESTful API</code> 来进行通信。</p><p>  这里还需要了解几个概念:</p><ul><li><code>Docker daemon（ Docker守护进程）</code></li></ul><blockquote><p>  <code>Docker daemon</code>是一个运行在宿主机（ <code>DOCKER-HOST</code>）的后台进程。可通过 <code>Docker</code>客户端与之通信。</p></blockquote><ul><li><code>Client（ Docker客户端）</code></li></ul><blockquote><p>  <code>Docker</code>客户端是 <code>Docker</code>的用户界面，它可以接受用户命令和配置标识，并与 <code>Docker daemon</code>通信。图中， <code>docker build</code>等都是 <code>Docker</code>的相关命令。</p></blockquote><hr><h4 id="基础组件"><a class="markdownIt-Anchor" href="#基础组件"></a> 基础组件</h4><p>  想要学习<code>docker</code>来安装和部署, <code>docker</code>中包含几个核心的组件需要了解。<code>docker</code>核心组件包括:</p><ul><li><code>Docker Registry</code></li></ul><blockquote><p>  <code>Docker Registry</code>是一个集中存储与分发镜像的服务。通常构建完 <code>Docker</code>镜像后，就可在当前宿主机上运行。但如果想要在其他机器上运行这个镜像，就需要手动复制。此时可借助 <code>Docker Registry</code> 来避免镜像的手动复制。类似于<code>linux</code>的包管理器, 可以直接其他机器可以直接拉取。</p><p>  一个 <code>Docker Registry</code>可包含多个 <code>Docker</code>仓库，每个仓库可包含多个镜像标签，每个标签对应一个 <code>Docker</code>镜像。</p><p>  <code>Docker Registry</code>可分为公有<code>Docker Registry</code>和私有<code>Docker Registry</code>。 最常⽤的<code>Docker Registry</code>莫过于官⽅的<code>Docker Hub</code>， 这也是默认的<code>Docker Registry</code>。 <code>Docker Hub</code>上存放着⼤量优秀的镜像， 我们可使⽤<code>Docker</code>命令下载并使⽤。</p></blockquote><ul><li><code>Docker Images</code></li></ul><blockquote><p>  <code>Docker</code> 镜像是一个只读模板，它包含创建 <code>Docker</code> 容器的说明。它和系统安装光盘有点像，使用系统安装光盘可以安装系统，同理，使用<code>Docker</code>镜像可以运行 <code>Docker</code> 镜像中的程序。通过<code>Docker Registry</code> 进行分发, 类似<code>linux</code>下包管理器中的安装包。</p></blockquote><ul><li><code>Docker Container</code></li></ul><blockquote><p>  容器是镜像的可运行实例。镜像和容器的关系有点类似于面向对象中，类和对象的关系。可通过 <code>Docker API</code>或者 <code>CLI</code> 命令来启停、移动、删除容器。</p></blockquote><p>以上三个部分就是通常<code>docker</code>核心的组件。</p><hr><h4 id="docker安装"><a class="markdownIt-Anchor" href="#docker安装"></a> docker安装</h4><blockquote><p><code>Docker</code> 要求 <code>CentOS</code> 系统的内核版本高于 <code>3.10</code>, 通常可以使用<code>uname -a</code>来查看。</p></blockquote><p>  在新主机上首次安装 <code>Docker Engine-Community</code> 之前，需要设置 <code>Docker</code> 仓库。之后，您可以从仓库安装和更新 <code>Docker</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo apt-get update<br></code></pre></td></tr></table></figure><p>添加 <code>Docker</code> 的官方 <code>GPG</code> 密钥：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add -<br></code></pre></td></tr></table></figure><p><code>9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88</code> 通过搜索指纹的后<code>8</code>个字符，验证您现在是否拥有带有指纹的密钥。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo apt-key fingerprint 0EBFCD88<br><br>pub   rsa4096 2017-02-22 [SCEA]<br>      9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88<br>uid           [ unknown] Docker Release (CE deb) &lt;docker@docker.com&gt;<br>sub   rsa4096 2017-02-22 [S]<br></code></pre></td></tr></table></figure><p>使用以下指令设置稳定版仓库:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo add-apt-repository \<br>   <span class="hljs-string">&quot;deb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/ \</span><br><span class="hljs-string">  <span class="hljs-subst">$(lsb_release -cs)</span> \</span><br><span class="hljs-string">  stable&quot;</span><br></code></pre></td></tr></table></figure><p>安装 <code>Docker Engine-Community</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo apt-get update<br>$ sudo apt-get install docker-ce docker-ce-cli containerd.io<br></code></pre></td></tr></table></figure><p>如果需要安装特定的版本, 可以通过如下命令列出仓库可用版本:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ apt-cache madison docker-ce<br><br>  docker-ce | 5:18.09.1~3-0~ubuntu-xenial | https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu  xenial/stable amd64 Packages<br>  docker-ce | 5:18.09.0~3-0~ubuntu-xenial | https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu  xenial/stable amd64 Packages<br>  docker-ce | 18.06.1~ce~3-0~ubuntu       | https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu  xenial/stable amd64 Packages<br>  docker-ce | 18.06.0~ce~3-0~ubuntu       | https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu  xenial/stable amd64 Packages<br>  ...<br></code></pre></td></tr></table></figure><p>使用第二列中的版本字符串安装特定版本，例如 <code>5:18.09.1~3-0~ubuntu-xenia</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo apt-get install docker-ce=&lt;VERSION_STRING&gt; docker-ce-cli=&lt;VERSION_STRING&gt; containerd.io<br></code></pre></td></tr></table></figure><p>如果要使用 <code>Docker</code> 作为非 <code>root</code> 用户，则应考虑使用类似以下方式将用户添加到 <code>docker</code> 组：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo usermod -aG docker your-user<br></code></pre></td></tr></table></figure><p><strong>测试</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo docker run hello-world<br>Hello from Docker!<br>This message shows that your installation appears to be working correctly.<br><br>To generate this message, Docker took the following steps:<br> 1. The Docker client contacted the Docker daemon.<br> 2. The Docker daemon pulled the <span class="hljs-string">&quot;hello-world&quot;</span> image from the Docker Hub.<br>    (amd64)<br> 3. The Docker daemon created a new container from that image <span class="hljs-built_in">which</span> runs the<br>    executable that produces the output you are currently reading.<br> 4. The Docker daemon streamed that output to the Docker client, <span class="hljs-built_in">which</span> sent it<br>    to your terminal.<br><br>To try something more ambitious, you can run an Ubuntu container with:<br> $ docker run -it ubuntu bash<br><br>Share images, automate workflows, and more with a free Docker ID:<br> https://hub.docker.com/<br><br>For more examples and ideas, visit:<br> https://docs.docker.com/get-started/<br></code></pre></td></tr></table></figure><p>输出如上表示安装成功。</p><h4 id="卸载"><a class="markdownIt-Anchor" href="#卸载"></a> 卸载</h4><p><strong>删除安装包</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo apt-get purge docker-ce<br></code></pre></td></tr></table></figure><p><strong>删除镜像、容器、配置文件</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo <span class="hljs-built_in">rm</span> -rf /var/lib/docker<br></code></pre></td></tr></table></figure><h4 id="配置加速"><a class="markdownIt-Anchor" href="#配置加速"></a> 配置加速</h4><p>  国内从 <code>DockerHub</code> 拉取镜像有时会遇到困难，此时可以配置镜像加速器。<code>Docker</code> 官方和国内很多云服务商都提供了国内加速器服务，例如：</p><ul><li>科大镜像：<code>https://docker.mirrors.ustc.edu.cn/</code></li><li>网易：<code>https://hub-mirror.c.163.com/</code></li><li>阿里云：<code>https://&lt;你的ID&gt;.mirror.aliyuncs.com</code></li><li>七牛云加速器：<code>https://reg-mirror.qiniu.com</code></li></ul><p>当配置某一个加速器地址之后，若发现拉取不到镜像，请切换到另一个加速器地址。国内各大云服务商均提供了 <code>Docker</code> 镜像加速服务，建议根据运行 <code>Docker</code> 的云平台选择对应的镜像加速服务。</p><p>这里以<code>ubuntu18.04</code>为例, 修改<code>/etc/default/docker</code>文件, 修改<code>DOCKER_OPTS</code>加速地址:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">DOCKER_OPTS=<span class="hljs-string">&quot;--registry-mirror=https://registry.docker-cn.com&quot;</span><br></code></pre></td></tr></table></figure><p>保存重新启动服务:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo service docker restart<br></code></pre></td></tr></table></figure><p>对于使用 <code>systemd</code> 的系统，请在 <code>/etc/docker/daemon.json</code> 中写入如下内容（如果文件不存在请新建该文件）：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">&#123;<br>    <span class="hljs-string">&quot;registry-mirrors&quot;</span>:[<br>    <span class="hljs-string">&quot;https://mirror.ccs.tencentyun.com&quot;</span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><p>重启服务:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo systemctl daemon-reload<br>$ sudo systemctl restart docker<br></code></pre></td></tr></table></figure><p>至此介绍了如何安装、配置、卸载 <code>docker</code>。</p><hr><h4 id="基础命令"><a class="markdownIt-Anchor" href="#基础命令"></a> 基础命令</h4><h5 id="获取帮助"><a class="markdownIt-Anchor" href="#获取帮助"></a> 获取帮助</h5><p>  在开始<code>docker</code>学习前, 首先要知道如何获取帮助。<code>docker</code>支持很多的命令, 我们可用通过如下格式获取帮助:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">command</span> --<span class="hljs-built_in">help</span><br></code></pre></td></tr></table></figure><p>比如:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─ubuntu@server-etcfly-pc ~<br>╰─$ docker info --<span class="hljs-built_in">help</span><br><br>Usage:  docker info [OPTIONS]<br><br>Display system-wide information<br><br>Aliases:<br>  docker system info, docker info<br><br>Options:<br>  -f, --format string   Format the output using the given Go template<br></code></pre></td></tr></table></figure><hr><h5 id="镜像"><a class="markdownIt-Anchor" href="#镜像"></a> 镜像</h5><p><code>docker</code>主要以<code>docker client</code>来运行容器, 也就是说容器是<code>docker</code>的运行单元。想要创建得到一个容器, 必须获得一个镜像, 镜像主要通过两种方式获得：</p><ul><li>第三方已经制作好的镜像仓库拉取</li><li>自己制作镜像(<code>docker build</code>命令制作)<br>这里<code>docker</code>镜像就像是程序中的类一样, 类似一个模板, 而容器是其实例化的可运行实体。</li></ul><h6 id="docker-version"><a class="markdownIt-Anchor" href="#docker-version"></a> docker version</h6><p>  获取<code>docker</code>的当前版本。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker version                                                                                130 ↵<br>Client: Docker Engine - Community<br> Version:           23.0.1<br> API version:       1.42<br> Go version:        go1.19.5<br> Git commit:        a5ee5b1<br> Built:             Thu Feb  9 19:46:49 2023<br> OS/Arch:           linux/amd64<br> Context:           default<br><br>Server: Docker Engine - Community<br> Engine:<br>  Version:          23.0.1<br>  API version:      1.42 (minimum version 1.12)<br>  Go version:       go1.19.5<br>  Git commit:       bc3805a<br>  Built:            Thu Feb  9 19:46:49 2023<br>  OS/Arch:          linux/amd64<br>  Experimental:     <span class="hljs-literal">false</span><br> containerd:<br>  Version:          1.6.18<br>  GitCommit:        2456e983eb9e37e47538f59ea18f2043c9a73640<br> runc:<br>  Version:          1.1.4<br>  GitCommit:        v1.1.4-0-g5fd4c4d<br> docker-init:<br>  Version:          0.19.0<br>  GitCommit:        de40ad0<br></code></pre></td></tr></table></figure><hr><h6 id="docker-search"><a class="markdownIt-Anchor" href="#docker-search"></a> docker search</h6><p>  <code>docker</code>的镜像如此重要, 那么我们哪里回去镜像呢？答案是仓库, 官方仓库地址: <a target="_blank" rel="noopener" href="https://hub.docker.com/">Docker Hub</a>, 当然不止 <code>docker hub</code>，只是远程的服务商不一样，操作都是一样的。</p><p>如下是从仓库搜索特定镜像的结果:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker search emqx                                                                              1 ↵<br>NAME                            DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED<br>emqx                            The most scalable open-source MQTT broker fo…   48        [OK]<br>emqx/emqx                       The most scalable open-source MQTT broker fo…   175<br>emqx/emqx-ee                    Official docker image <span class="hljs-keyword">for</span> EMQX Enterprise, a…   13<br>emqx/build-env                                                                  0<br>emqx/emqx-edge                  EMQ X Broker - Massively Scalable MQTT Messa…   3<br>emqx/emqx-operator-reloader                                                     0<br>emqx/kuiper                     A lightweight IoT edge analytics software ht…   2<br></code></pre></td></tr></table></figure><p>以上列表包含五列，含义如下：</p><ul><li><code>NAME</code>:镜像仓库名称。</li><li><code>DESCRIPTION</code>: 镜像仓库描述。</li><li><code>STARS</code>：镜像仓库收藏数，表示该镜像仓库的受欢迎程度，类似于 <code>GitHub</code>的 <code>star</code></li><li><code>OFFICAL</code>:表示是否为官方仓库，该列标记为<code>[0K]</code>的镜像均由各软件的官方项目组创建和维护</li><li><code>AUTOMATED</code>：表示是否是自动构建的镜像仓库</li></ul><hr><h6 id="docker-pull"><a class="markdownIt-Anchor" href="#docker-pull"></a> docker pull</h6><p>  当需要下载一个镜像, 可用使用<code>pull</code> 命令拉群, 这里拉取一个<code>ubuntu</code>的示例:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull ubuntu<br></code></pre></td></tr></table></figure><p>结果如下:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker pull ubuntu                                                                              1 ↵<br>[sudo] password <span class="hljs-keyword">for</span> etcfly:<br>Using default tag: latest<br>latest: Pulling from library/ubuntu<br>2ab09b027e7f: Pull complete<br>Digest: sha256:67211c14fa74f070d27cc59d69a7fa9aeff8e28ea118ef3babc295a0428a6d21<br>Status: Downloaded newer image <span class="hljs-keyword">for</span> ubuntu:latest<br>docker.io/library/ubuntu:latest<br></code></pre></td></tr></table></figure><hr><h6 id="docker-images"><a class="markdownIt-Anchor" href="#docker-images"></a> docker images</h6><p>  当下载的镜像比较多, 怎么知道当前存在哪些镜像呢？可以使用<code>images</code>命令列出当前所有镜像。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker images<br>REPOSITORY   TAG       IMAGE ID       CREATED       SIZE<br>emqx/emqx    latest    af931b5ce7e5   2 weeks ago   381MB<br>ubuntu       latest    08d22c0ceb15   4 weeks ago   77.8MB<br></code></pre></td></tr></table></figure><p>以上列表含义如下:</p><ul><li><code>REPOSITORY</code>：镜像所属仓库名称。</li><li><code>TAG</code>:镜像标签。默认是 <code>latest</code>,表示最新。</li><li><code>IMAGE ID</code>：镜像 <code>ID</code>，表示镜像唯一标识。</li><li><code>CREATED</code>：镜像创建时间。</li><li><code>SIZE</code>: 镜像大小。</li></ul><hr><h6 id="docker-rmi"><a class="markdownIt-Anchor" href="#docker-rmi"></a> docker rmi</h6><p>  当一些镜像已经没用, 可以该命令删除。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker rmi 08d22c0ceb15<br></code></pre></td></tr></table></figure><p>也可以强制删除, 具体可以参看<code>docker rmi --help</code>。</p><hr><h6 id="docker-tag"><a class="markdownIt-Anchor" href="#docker-tag"></a> docker tag</h6><p>  为 <code>docker</code>镜像添加新的标签。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker ps -a<br>CONTAINER ID   IMAGE              COMMAND                  CREATED       STATUS         PORTS                                                                                                                                                                                                         NAMES<br>8acb93525b8f   emqx/emqx:latest   <span class="hljs-string">&quot;/usr/bin/docker-ent…&quot;</span>   6 hours ago   Up 3 seconds   4370/tcp, 0.0.0.0:1883-&gt;1883/tcp, :::1883-&gt;1883/tcp, 0.0.0.0:8083-8084-&gt;8083-8084/tcp, :::8083-8084-&gt;8083-8084/tcp, 5369/tcp, 0.0.0.0:8883-&gt;8883/tcp, :::8883-&gt;8883/tcp, 11883/tcp, 0.0.0.0:10000-&gt;18083/tcp, :::10000-&gt;18083/tcp   emqx<br>╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker tag emqx/emqx:latest local-emqx<br>╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker images<br>REPOSITORY   TAG       IMAGE ID       CREATED       SIZE<br>emqx/emqx    latest    af931b5ce7e5   2 weeks ago   381MB<br>local-emqx   latest    af931b5ce7e5   2 weeks ago   381MB<br>ubuntu       latest    08d22c0ceb15   4 weeks ago   77.8MB<br></code></pre></td></tr></table></figure><hr><h5 id="容器"><a class="markdownIt-Anchor" href="#容器"></a> 容器</h5><p>  容器是镜像运行的实体, 如下将介绍容器的创建、运行、启动、删除等命令。</p><h6 id="docker-run"><a class="markdownIt-Anchor" href="#docker-run"></a> docker run</h6><p>  使用以下<code>docker run</code>命令即可新建并启动一个容器，该命令是最常用的命令，它有很多选项:</p><ul><li><code>-d</code>: 表示后台运行</li><li><code>-P</code>: 随机端口映射</li><li><code>-p</code>选项：指定端口映射，有以下四种格式:<ul><li><code>ip:hostPort:containerPort</code></li><li><code>ip::containerPort</code></li><li><code>hostPort:containerPort</code></li><li><code>containerPort</code></li></ul></li><li><code>--network=type</code>选项：指定网络模式</li></ul><p><img src="/2023/04/09/docker/base-common/213142/docker-run-network.png" srcset="/img/loading.gif" lazyload alt="docker-run-network.png"></p><p>需要注意的是，使用 <code>docker run</code> 命令创建容器时，会先检查本地是否存在指定镜像。如果本地不存在该名称的镜像， <code>Docker</code> 就会自动从 <code>Docker Hub</code> 下载镜像并启动一个 <code>Docker</code> 容器。</p><hr><h6 id="docker-ps"><a class="markdownIt-Anchor" href="#docker-ps"></a> docker ps</h6><p>  当容器被创建以后, 除非手动删除不然一直存在即使不运行。可通过<code>docker ps</code>查看本地的容器:</p><p><strong>列出运行中的容器</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker ps<br></code></pre></td></tr></table></figure><p><strong>列出本地所有容器(在线和离线)</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker ps -a<br></code></pre></td></tr></table></figure><p><strong>列出在线容器</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker ps -a -f status=running<br></code></pre></td></tr></table></figure><p>结果如下:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">CONTAINER ID   IMAGE              COMMAND                  CREATED       STATUS       PORTS                                                                                                                                                                                                                               NAMES<br>8acb93525b8f   emqx/emqx:latest   <span class="hljs-string">&quot;/usr/bin/docker-ent…&quot;</span>   4 hours ago   Up 4 hours   4370/tcp, 0.0.0.0:1883-&gt;1883/tcp, :::1883-&gt;1883/tcp, 0.0.0.0:8083-8084-&gt;8083-8084/tcp, :::8083-8084-&gt;8083-8084/tcp, 5369/tcp, 0.0.0.0:8883-&gt;8883/tcp, :::8883-&gt;8883/tcp, 11883/tcp, 0.0.0.0:10000-&gt;18083/tcp, :::10000-&gt;18083/tcp   emqx<br></code></pre></td></tr></table></figure><p>各项内容如下:</p><ul><li><code>CONTAINER_ID</code>：表示容器 <code>ID</code>。</li><li><code>IMAGE</code>: 表示镜像名称。</li><li><code>COMMAND</code>：表示启动容器时运行的命令。</li><li><code>CREATED</code>：表示容器的创建时间。</li><li><code>STATUS</code>：表示容器运行的状态。<code>UP</code>表示运行中， <code>Exited</code> 表示已停止。</li><li><code>PORTS</code>: 表示容器对外的端口号。</li><li><code>NAMES</code>: 表示容器名称。该名称默认由 <code>Docker</code> 自动生成，也可使用 <code>docker run</code> 命令的 <code>--name</code> 选项自行指定。</li></ul><hr><h6 id="docker-stop"><a class="markdownIt-Anchor" href="#docker-stop"></a> docker stop</h6><p>  停止一个<code>docker</code>容器。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker stop [容器]<br></code></pre></td></tr></table></figure><p>容器可以是<code>id</code>(容器<code>id</code>可以通过<code>docker ps</code>命令获取), 也可以是容器名。</p><h6 id="docker-kill"><a class="markdownIt-Anchor" href="#docker-kill"></a> docker kill</h6><p>  强制停止一个<code>docker</code>容器。可使用 <code>docker kill</code>命令发送 <code>SIGKILL</code>信号来强制停止容器。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">kill</span> [容器]<br></code></pre></td></tr></table></figure><p>类似于<code>stop</code>命令。</p><hr><h6 id="docker-start"><a class="markdownIt-Anchor" href="#docker-start"></a> docker start</h6><p>和<code>docker stop</code>命令类似。<code>start</code>命令用于启动一个容器。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker start [容器]<br></code></pre></td></tr></table></figure><hr><h6 id="docker-rm"><a class="markdownIt-Anchor" href="#docker-rm"></a> docker rm</h6><p>  使用<code>rmi</code>命令可以删除一个镜像, <code>rm</code>命令可以用来删除一个容器。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker <span class="hljs-built_in">rm</span> [容器<span class="hljs-built_in">id</span>]<br></code></pre></td></tr></table></figure><p><strong>删除所有未运行的容器</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker <span class="hljs-built_in">rm</span> `docker ps -aq status=exited`<br></code></pre></td></tr></table></figure><hr><h6 id="docker-inspect"><a class="markdownIt-Anchor" href="#docker-inspect"></a> docker inspect</h6><p>  查看某个容器所有信息。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker inspect [容器]<br></code></pre></td></tr></table></figure><p>结果如下:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker inspect 8acb93525b8f                                                                     1 ↵<br>[<br>    &#123;<br>        <span class="hljs-string">&quot;Id&quot;</span>: <span class="hljs-string">&quot;8acb93525b8ffa6e2285245c270704afe1f89043b389701be4b36d03650ff51a&quot;</span>,<br>        <span class="hljs-string">&quot;Created&quot;</span>: <span class="hljs-string">&quot;2023-04-09T05:04:30.618704045Z&quot;</span>,<br>        <span class="hljs-string">&quot;Path&quot;</span>: <span class="hljs-string">&quot;/usr/bin/docker-entrypoint.sh&quot;</span>,<br>        <span class="hljs-string">&quot;Args&quot;</span>: [<br>            <span class="hljs-string">&quot;/opt/emqx/bin/emqx&quot;</span>,<br>            <span class="hljs-string">&quot;foreground&quot;</span><br>        ],<br>        <span class="hljs-string">&quot;State&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Status&quot;</span>: <span class="hljs-string">&quot;running&quot;</span>,<br>            <span class="hljs-string">&quot;Running&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;Paused&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Restarting&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OOMKilled&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Dead&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Pid&quot;</span>: 10620,<br>            <span class="hljs-string">&quot;ExitCode&quot;</span>: 0,<br>            <span class="hljs-string">&quot;Error&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;StartedAt&quot;</span>: <span class="hljs-string">&quot;2023-04-09T05:04:32.94659897Z&quot;</span>,<br>            <span class="hljs-string">&quot;FinishedAt&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;sha256:af931b5ce7e5f19708e2c6839ca2a27b036f9d836c74c432042d0b440472fee2&quot;</span>,<br>        <span class="hljs-string">&quot;ResolvConfPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/8acb93525b8ffa6e2285245c270704afe1f89043b389701be4b36d03650ff51a/resolv.conf&quot;</span>,<br>        <span class="hljs-string">&quot;HostnamePath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/8acb93525b8ffa6e2285245c270704afe1f89043b389701be4b36d03650ff51a/hostname&quot;</span>,<br>        <span class="hljs-string">&quot;HostsPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/8acb93525b8ffa6e2285245c270704afe1f89043b389701be4b36d03650ff51a/hosts&quot;</span>,<br>        <span class="hljs-string">&quot;LogPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/8acb93525b8ffa6e2285245c270704afe1f89043b389701be4b36d03650ff51a/8acb93525b8ffa6e2285245c270704afe1f89043b389701be4b36d03650ff51a-json.log&quot;</span>,<br>        <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;/emqx&quot;</span>,<br>        <span class="hljs-string">&quot;RestartCount&quot;</span>: 0,<br>        <span class="hljs-string">&quot;Driver&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span>,<br>        <span class="hljs-string">&quot;Platform&quot;</span>: <span class="hljs-string">&quot;linux&quot;</span>,<br>        <span class="hljs-string">&quot;MountLabel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;ProcessLabel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;AppArmorProfile&quot;</span>: <span class="hljs-string">&quot;docker-default&quot;</span>,<br>        <span class="hljs-string">&quot;ExecIDs&quot;</span>: null,<br>        <span class="hljs-string">&quot;HostConfig&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Binds&quot;</span>: null,<br>            <span class="hljs-string">&quot;ContainerIDFile&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;LogConfig&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;Type&quot;</span>: <span class="hljs-string">&quot;json-file&quot;</span>,<br>                <span class="hljs-string">&quot;Config&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;NetworkMode&quot;</span>: <span class="hljs-string">&quot;default&quot;</span>,<br>            <span class="hljs-string">&quot;PortBindings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;18083/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;10000&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;1883/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;1883&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;8083/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8083&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;8084/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8084&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;8883/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8883&quot;</span><br>                    &#125;<br>                ]<br>            &#125;,<br>            <span class="hljs-string">&quot;RestartPolicy&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;no&quot;</span>,<br>                <span class="hljs-string">&quot;MaximumRetryCount&quot;</span>: 0<br>            &#125;,<br>            <span class="hljs-string">&quot;AutoRemove&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;VolumeDriver&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;VolumesFrom&quot;</span>: null,<br>            <span class="hljs-string">&quot;ConsoleSize&quot;</span>: [<br>                28,<br>                109<br>            ],<br>            <span class="hljs-string">&quot;CapAdd&quot;</span>: null,<br>            <span class="hljs-string">&quot;CapDrop&quot;</span>: null,<br>            <span class="hljs-string">&quot;CgroupnsMode&quot;</span>: <span class="hljs-string">&quot;host&quot;</span>,<br>            <span class="hljs-string">&quot;Dns&quot;</span>: [],<br>            <span class="hljs-string">&quot;DnsOptions&quot;</span>: [],<br>            <span class="hljs-string">&quot;DnsSearch&quot;</span>: [],<br>            <span class="hljs-string">&quot;ExtraHosts&quot;</span>: null,<br>            <span class="hljs-string">&quot;GroupAdd&quot;</span>: null,<br>            <span class="hljs-string">&quot;IpcMode&quot;</span>: <span class="hljs-string">&quot;private&quot;</span>,<br>            <span class="hljs-string">&quot;Cgroup&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Links&quot;</span>: null,<br>            <span class="hljs-string">&quot;OomScoreAdj&quot;</span>: 0,<br>            <span class="hljs-string">&quot;PidMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Privileged&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;PublishAllPorts&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ReadonlyRootfs&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;SecurityOpt&quot;</span>: null,<br>            <span class="hljs-string">&quot;UTSMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;UsernsMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;ShmSize&quot;</span>: 67108864,<br>            <span class="hljs-string">&quot;Runtime&quot;</span>: <span class="hljs-string">&quot;runc&quot;</span>,<br>            <span class="hljs-string">&quot;Isolation&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;CpuShares&quot;</span>: 0,<br>            <span class="hljs-string">&quot;Memory&quot;</span>: 0,<br>            <span class="hljs-string">&quot;NanoCpus&quot;</span>: 0,<br>            <span class="hljs-string">&quot;CgroupParent&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;BlkioWeight&quot;</span>: 0,<br>            <span class="hljs-string">&quot;BlkioWeightDevice&quot;</span>: [],<br>            <span class="hljs-string">&quot;BlkioDeviceReadBps&quot;</span>: [],<br>            <span class="hljs-string">&quot;BlkioDeviceWriteBps&quot;</span>: [],<br>            <span class="hljs-string">&quot;BlkioDeviceReadIOps&quot;</span>: [],<br>            <span class="hljs-string">&quot;BlkioDeviceWriteIOps&quot;</span>: [],<br>            <span class="hljs-string">&quot;CpuPeriod&quot;</span>: 0,<br>            <span class="hljs-string">&quot;CpuQuota&quot;</span>: 0,<br>            <span class="hljs-string">&quot;CpuRealtimePeriod&quot;</span>: 0,<br>            <span class="hljs-string">&quot;CpuRealtimeRuntime&quot;</span>: 0,<br>            <span class="hljs-string">&quot;CpusetCpus&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;CpusetMems&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Devices&quot;</span>: [],<br>            <span class="hljs-string">&quot;DeviceCgroupRules&quot;</span>: null,<br>            <span class="hljs-string">&quot;DeviceRequests&quot;</span>: null,<br>            <span class="hljs-string">&quot;MemoryReservation&quot;</span>: 0,<br>            <span class="hljs-string">&quot;MemorySwap&quot;</span>: 0,<br>            <span class="hljs-string">&quot;MemorySwappiness&quot;</span>: null,<br>            <span class="hljs-string">&quot;OomKillDisable&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;PidsLimit&quot;</span>: null,<br>            <span class="hljs-string">&quot;Ulimits&quot;</span>: null,<br>            <span class="hljs-string">&quot;CpuCount&quot;</span>: 0,<br>            <span class="hljs-string">&quot;CpuPercent&quot;</span>: 0,<br>            <span class="hljs-string">&quot;IOMaximumIOps&quot;</span>: 0,<br>            <span class="hljs-string">&quot;IOMaximumBandwidth&quot;</span>: 0,<br>            <span class="hljs-string">&quot;MaskedPaths&quot;</span>: [<br>                <span class="hljs-string">&quot;/proc/asound&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/acpi&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/kcore&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/keys&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/latency_stats&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/timer_list&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/timer_stats&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sched_debug&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/scsi&quot;</span>,<br>                <span class="hljs-string">&quot;/sys/firmware&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;ReadonlyPaths&quot;</span>: [<br>                <span class="hljs-string">&quot;/proc/bus&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/fs&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/irq&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sys&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sysrq-trigger&quot;</span><br>            ]<br>        &#125;,<br>        <span class="hljs-string">&quot;GraphDriver&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Data&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;LowerDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/44b5a75be8470031f3e8e7d2a36ecb7ea57a8e07e9c0d7a3c9b4268b84fe819c-init/diff:/var/lib/docker/overlay2/ae9a4b6ec2252cbee7a3266aba4a93295369f7aead4b2cb9cd3bb77b2bfea140/diff:/var/lib/docker/overlay2/f02d067f96b3f6e83359af9a50ddc92b057d14ad02b25d913ac6c4595fde49d5/diff:/var/lib/docker/overlay2/1f264117de285e81c974ab94036cca9e4a2040a4df4d6515e02ce3f15e66ea15/diff:/var/lib/docker/overlay2/2e3e239df22487305562a1608c596bb7a05d6d141c7b66b4cf9f714dda851816/diff:/var/lib/docker/overlay2/51054d2bf72f217bbc174643f2b42cfcd3e19f37c5409afda7bcf315f32f5eef/diff:/var/lib/docker/overlay2/be9fd44f6f868bb4f9f2ef9c4142c626bffba94e3fefb38a72343aa2e5c2c2a1/diff:/var/lib/docker/overlay2/8261c17cc6f4d64fc2473fbd15195739b0eb8b53e3952f55333201934a9898bc/diff&quot;</span>,<br>                <span class="hljs-string">&quot;MergedDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/44b5a75be8470031f3e8e7d2a36ecb7ea57a8e07e9c0d7a3c9b4268b84fe819c/merged&quot;</span>,<br>                <span class="hljs-string">&quot;UpperDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/44b5a75be8470031f3e8e7d2a36ecb7ea57a8e07e9c0d7a3c9b4268b84fe819c/diff&quot;</span>,<br>                <span class="hljs-string">&quot;WorkDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/44b5a75be8470031f3e8e7d2a36ecb7ea57a8e07e9c0d7a3c9b4268b84fe819c/work&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Mounts&quot;</span>: [<br>            &#123;<br>                <span class="hljs-string">&quot;Type&quot;</span>: <span class="hljs-string">&quot;volume&quot;</span>,<br>                <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;80c776f68c303e2a98213e8116576676293f84613372d899fa100339f693e3a6&quot;</span>,<br>                <span class="hljs-string">&quot;Source&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/volumes/80c776f68c303e2a98213e8116576676293f84613372d899fa100339f693e3a6/_data&quot;</span>,<br>                <span class="hljs-string">&quot;Destination&quot;</span>: <span class="hljs-string">&quot;/opt/emqx/data&quot;</span>,<br>                <span class="hljs-string">&quot;Driver&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>,<br>                <span class="hljs-string">&quot;Mode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                <span class="hljs-string">&quot;RW&quot;</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-string">&quot;Propagation&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-string">&quot;Type&quot;</span>: <span class="hljs-string">&quot;volume&quot;</span>,<br>                <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;51f9fa606947e5126f9d60cec8983ca8a047a6299b76fb176cfcd59815430040&quot;</span>,<br>                <span class="hljs-string">&quot;Source&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/volumes/51f9fa606947e5126f9d60cec8983ca8a047a6299b76fb176cfcd59815430040/_data&quot;</span>,<br>                <span class="hljs-string">&quot;Destination&quot;</span>: <span class="hljs-string">&quot;/opt/emqx/log&quot;</span>,<br>                <span class="hljs-string">&quot;Driver&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>,<br>                <span class="hljs-string">&quot;Mode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                <span class="hljs-string">&quot;RW&quot;</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-string">&quot;Propagation&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-string">&quot;Config&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Hostname&quot;</span>: <span class="hljs-string">&quot;8acb93525b8f&quot;</span>,<br>            <span class="hljs-string">&quot;Domainname&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;User&quot;</span>: <span class="hljs-string">&quot;emqx&quot;</span>,<br>            <span class="hljs-string">&quot;AttachStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStdout&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStderr&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ExposedPorts&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;11883/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;18083/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;1883/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;4370/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;5369/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;8083/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;8084/tcp&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;8883/tcp&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;Tty&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OpenStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;StdinOnce&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Env&quot;</span>: [<br>                <span class="hljs-string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>,<br>                <span class="hljs-string">&quot;LC_ALL=C.UTF-8&quot;</span>,<br>                <span class="hljs-string">&quot;LANG=C.UTF-8&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Cmd&quot;</span>: [<br>                <span class="hljs-string">&quot;/opt/emqx/bin/emqx&quot;</span>,<br>                <span class="hljs-string">&quot;foreground&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;emqx/emqx:latest&quot;</span>,<br>            <span class="hljs-string">&quot;Volumes&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;/opt/emqx/data&quot;</span>: &#123;&#125;,<br>                <span class="hljs-string">&quot;/opt/emqx/log&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;WorkingDir&quot;</span>: <span class="hljs-string">&quot;/opt/emqx&quot;</span>,<br>            <span class="hljs-string">&quot;Entrypoint&quot;</span>: [<br>                <span class="hljs-string">&quot;/usr/bin/docker-entrypoint.sh&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;OnBuild&quot;</span>: null,<br>            <span class="hljs-string">&quot;Labels&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;org.opencontainers.image.created&quot;</span>: <span class="hljs-string">&quot;2023-03-24T17:33:30.163Z&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.description&quot;</span>: <span class="hljs-string">&quot;The most scalable open-source MQTT broker for IoT, IIoT, and connected vehicles&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.edition&quot;</span>: <span class="hljs-string">&quot;Opensource&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.licenses&quot;</span>: <span class="hljs-string">&quot;NOASSERTION&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.otp.version&quot;</span>: <span class="hljs-string">&quot;24.3.4.2-2&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.revision&quot;</span>: <span class="hljs-string">&quot;3490a7dc1dfd1924d2d7e834306f78b5bfa027e3&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.source&quot;</span>: <span class="hljs-string">&quot;https://github.com/emqx/emqx&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.title&quot;</span>: <span class="hljs-string">&quot;emqx&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.url&quot;</span>: <span class="hljs-string">&quot;https://github.com/emqx/emqx&quot;</span>,<br>                <span class="hljs-string">&quot;org.opencontainers.image.version&quot;</span>: <span class="hljs-string">&quot;5.0.21&quot;</span><br>            &#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;NetworkSettings&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Bridge&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;SandboxID&quot;</span>: <span class="hljs-string">&quot;0489c0864f0f78e86378776364ba4ebd02163cdadc6eac02a14f8238ba6cadd2&quot;</span>,<br>            <span class="hljs-string">&quot;HairpinMode&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;LinkLocalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;LinkLocalIPv6PrefixLen&quot;</span>: 0,<br>            <span class="hljs-string">&quot;Ports&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;11883/tcp&quot;</span>: null,<br>                <span class="hljs-string">&quot;18083/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;10000&quot;</span><br>                    &#125;,<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;::&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;10000&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;1883/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;1883&quot;</span><br>                    &#125;,<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;::&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;1883&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;4370/tcp&quot;</span>: null,<br>                <span class="hljs-string">&quot;5369/tcp&quot;</span>: null,<br>                <span class="hljs-string">&quot;8083/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8083&quot;</span><br>                    &#125;,<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;::&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8083&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;8084/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8084&quot;</span><br>                    &#125;,<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;::&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8084&quot;</span><br>                    &#125;<br>                ],<br>                <span class="hljs-string">&quot;8883/tcp&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8883&quot;</span><br>                    &#125;,<br>                    &#123;<br>                        <span class="hljs-string">&quot;HostIp&quot;</span>: <span class="hljs-string">&quot;::&quot;</span>,<br>                        <span class="hljs-string">&quot;HostPort&quot;</span>: <span class="hljs-string">&quot;8883&quot;</span><br>                    &#125;<br>                ]<br>            &#125;,<br>            <span class="hljs-string">&quot;SandboxKey&quot;</span>: <span class="hljs-string">&quot;/var/run/docker/netns/0489c0864f0f&quot;</span>,<br>            <span class="hljs-string">&quot;SecondaryIPAddresses&quot;</span>: null,<br>            <span class="hljs-string">&quot;SecondaryIPv6Addresses&quot;</span>: null,<br>            <span class="hljs-string">&quot;EndpointID&quot;</span>: <span class="hljs-string">&quot;43e1431ceb9c96bc44ffe74a33d2f612f895144a9deb0d835e15c409122b54db&quot;</span>,<br>            <span class="hljs-string">&quot;Gateway&quot;</span>: <span class="hljs-string">&quot;172.17.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;GlobalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;GlobalIPv6PrefixLen&quot;</span>: 0,<br>            <span class="hljs-string">&quot;IPAddress&quot;</span>: <span class="hljs-string">&quot;172.17.0.2&quot;</span>,<br>            <span class="hljs-string">&quot;IPPrefixLen&quot;</span>: 16,<br>            <span class="hljs-string">&quot;IPv6Gateway&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;MacAddress&quot;</span>: <span class="hljs-string">&quot;02:42:ac:11:00:02&quot;</span>,<br>            <span class="hljs-string">&quot;Networks&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;bridge&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;IPAMConfig&quot;</span>: null,<br>                    <span class="hljs-string">&quot;Links&quot;</span>: null,<br>                    <span class="hljs-string">&quot;Aliases&quot;</span>: null,<br>                    <span class="hljs-string">&quot;NetworkID&quot;</span>: <span class="hljs-string">&quot;e08cf87a452230419ba7e1bfbc64004b191fffd03642b5fcc2372e58820470e0&quot;</span>,<br>                    <span class="hljs-string">&quot;EndpointID&quot;</span>: <span class="hljs-string">&quot;43e1431ceb9c96bc44ffe74a33d2f612f895144a9deb0d835e15c409122b54db&quot;</span>,<br>                    <span class="hljs-string">&quot;Gateway&quot;</span>: <span class="hljs-string">&quot;172.17.0.1&quot;</span>,<br>                    <span class="hljs-string">&quot;IPAddress&quot;</span>: <span class="hljs-string">&quot;172.17.0.2&quot;</span>,<br>                    <span class="hljs-string">&quot;IPPrefixLen&quot;</span>: 16,<br>                    <span class="hljs-string">&quot;IPv6Gateway&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;GlobalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;GlobalIPv6PrefixLen&quot;</span>: 0,<br>                    <span class="hljs-string">&quot;MacAddress&quot;</span>: <span class="hljs-string">&quot;02:42:ac:11:00:02&quot;</span>,<br>                    <span class="hljs-string">&quot;DriverOpts&quot;</span>: null<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>]<br></code></pre></td></tr></table></figure><hr><h6 id="docker-container-logs"><a class="markdownIt-Anchor" href="#docker-container-logs"></a> docker container logs</h6><p>  查看某个容器的日志信息。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker container logs [容器]<br></code></pre></td></tr></table></figure><p>结果如下:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker container logs 8acb93525b8f                                                            130 ↵<br>WARNING: Default (insecure) Erlang cookie is <span class="hljs-keyword">in</span> use.<br>WARNING: Configure node.cookie <span class="hljs-keyword">in</span> /opt/emqx/etc/emqx.conf or override from environment variable EMQX_NODE__COOKIE<br>WARNING: NOTE: Use the same cookie <span class="hljs-keyword">for</span> all nodes <span class="hljs-keyword">in</span> the cluster.<br>EMQX_RPC__PORT_DISCOVERY [rpc.port_discovery]: manual<br>EMQX_LOG__FILE_HANDLERS__DEFAULT__ENABLE [log.file_handlers.default.enable]: <span class="hljs-literal">false</span><br>EMQX_LOG__CONSOLE_HANDLER__ENABLE [log.console_handler.enable]: <span class="hljs-literal">true</span><br>EMQX_NODE__NAME [node.name]: emqx@172.17.0.2<br>Listener ssl:default on 0.0.0.0:8883 started.<br>Listener tcp:default on 0.0.0.0:1883 started.<br>Listener ws:default on 0.0.0.0:8083 started.<br>Listener wss:default on 0.0.0.0:8084 started.<br>Listener http:dashboard on :18083 started.<br>EMQX 5.0.21 is running now!<br></code></pre></td></tr></table></figure><hr><h6 id="docker-top"><a class="markdownIt-Anchor" href="#docker-top"></a> docker top</h6><p>  查看容器中的进程信息。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker top [容器]<br></code></pre></td></tr></table></figure><p>结果如下:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker top 8acb93525b8f<br>UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD<br>etcfly              10620               10591               1                   13:04               ?                   00:03:35            emqx -Bd -spp <span class="hljs-literal">true</span> -A 4 -IOt 4 -SDio 8 -e 262144 -zdbbl 8192 -Q 1048576 -P 2097152 -- -root /opt/emqx -progname /opt/emqx/bin/emqx -- -home /home/emqx -- -noshell -noshell -noinput -boot /opt/emqx/releases/5.0.21/start -boot_var RELEASE_LIB /opt/emqx/lib -boot_var ERTS_LIB_DIR /opt/emqx/lib -mode embedded -config /opt/emqx/data/configs/app.2023.04.09.05.04.34.config -stdlib restricted_shell emqx_restricted_shell -shutdown_time 30000 -pa data/patches -mnesia dump_log_write_threshold 5000 -mnesia dump_log_time_threshold 60000 -os_mon start_disksup <span class="hljs-literal">false</span> -pa /opt/emqx/releases/5.0.21/consolidated -kernel net_ticktime 120 -setcookie emqxsecretcookie -name emqx@172.17.0.2 -mnesia <span class="hljs-built_in">dir</span> <span class="hljs-string">&quot;/opt/emqx/data/mnesia/emqx@172.17.0.2&quot;</span> -- -start_epmd <span class="hljs-literal">false</span> -epmd_module ekka_epmd -proto_dist ekka -- foreground -emqx_data_dir /opt/emqx/data --<br>etcfly              10928               10620               0                   13:04               ?                   00:00:00            erl_child_setup 1048576<br>etcfly              10960               10928               0                   13:04               ?                   00:00:04            /opt/emqx/lib/os_mon-2.7.1/priv/bin/memsup<br>etcfly              10961               10928               0                   13:04               ?                   00:00:00            /opt/emqx/lib/os_mon-2.7.1/priv/bin/cpu_sup<br>etcfly              10965               10928               0                   13:04               ?                   00:00:00            inet_gethost 4<br>etcfly              10966               10965               0                   13:04               ?                   00:00:00            inet_gethost 4<br></code></pre></td></tr></table></figure><hr><h6 id="docker-cp"><a class="markdownIt-Anchor" href="#docker-cp"></a> docker cp</h6><p>  主要用于容器和宿主机之间的文件复制。</p><ul><li>从容器里面拷文件到宿主机</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">cp</span> 容器<span class="hljs-built_in">id</span>:要拷贝的文件在容器里面的路径 宿主机的相应路径<br></code></pre></td></tr></table></figure><ul><li>从宿主机拷文件到容器里面</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">cp</span> 要拷贝的宿主机文件路径 容器<span class="hljs-built_in">id</span>:要拷贝到容器里面对应的路径<br></code></pre></td></tr></table></figure><hr><h6 id="docker-stats"><a class="markdownIt-Anchor" href="#docker-stats"></a> docker stats</h6><p>  查看容器使用的资源信息。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">$ sudo docker stats emqx<br>CONTAINER ID   NAME      CPU %     MEM USAGE / LIMIT     MEM %     NET I/O          BLOCK I/O         PIDS<br>8acb93525b8f   emqx      1.27%     153.8MiB / 3.743GiB   4.01%     215kB / 13.4MB   1.79MB / 5.01MB   42<br></code></pre></td></tr></table></figure><hr><h6 id="docker-export"><a class="markdownIt-Anchor" href="#docker-export"></a> docker export</h6><p>  如果要导出本地某个容器，可以使用 <code>docker export</code> 命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker <span class="hljs-built_in">export</span> emqx -o emqx.tar<br></code></pre></td></tr></table></figure><p><code>-o</code>参数后面接导出的文件名。, <code>emqx</code>表示需要被导出的容器。</p><hr><h6 id="docker-import"><a class="markdownIt-Anchor" href="#docker-import"></a> docker import</h6><p>  当需要重新导入<code>docker export</code>导出的容器时, 执行<code>import</code>命令重新导入。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker import emqx.tar etcfly-emqx                                                              1 ↵<br>sha256:df0d587b75d0e8e24f2e4b5ee5dc029c381616eb529ae839fd4f349f1b5ccff3<br></code></pre></td></tr></table></figure><ul><li><code>emqx.tar</code>: 之前导出的镜像归档文件</li><li><code>etcfly-emqx</code> : 导出生成的新仓库名</li></ul><p>结果如下:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">╭─etcfly@etcfly-pc ~<br>╰─$ sudo docker images                                                                                 130 ↵<br>REPOSITORY    TAG       IMAGE ID       CREATED              SIZE<br>etcfly-emqx   latest    df0d587b75d0   About a minute ago   232MB<br>emqx/emqx     latest    af931b5ce7e5   2 weeks ago          381MB<br>ubuntu        latest    08d22c0ceb15   4 weeks ago          77.8MB<br></code></pre></td></tr></table></figure><hr><h6 id="docker-exec"><a class="markdownIt-Anchor" href="#docker-exec"></a> docker exec</h6><p>  有时候需要进入<code>docker</code>执行一些命令或者安装相关工具, 那么需要该命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker <span class="hljs-built_in">exec</span> -it f0b1c8ab3633 /bin/bash (有的容器需要把 /bin/bash 换成 sh)<br></code></pre></td></tr></table></figure><p>进入后可以使用<code>apt</code>等工具进行安装。</p><hr><h5 id="远程仓库镜像"><a class="markdownIt-Anchor" href="#远程仓库镜像"></a> 远程仓库镜像</h5><p>  远程镜像仓库可以自己搭建也可以使用一些免费的平台, 这里使用 <a target="_blank" rel="noopener" href="https://hub.docker.com/">dockerHub</a> 官方的平台。使用官方平台注意需要自己注册账户。</p><ul><li>登录远程镜像仓库: <code>docker login</code> 用户信息 仓库地址</li></ul><blockquote><p>如果未指定镜像仓库地址，则默认为官方仓库 <code>Docker Hub</code><br><strong>示例</strong>:</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker login -u 用户名<br><span class="hljs-comment"># 登录到阿里云docker仓库</span><br>docker login --username=用户名  registry.cn-hangzhou.aliyuncs.com<br></code></pre></td></tr></table></figure><ul><li>拉取镜像：<code>docker pull</code> 镜像</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker pull registry.cn-hangzhou.aliyuncs.com/sessionboy/sinn:v1<br></code></pre></td></tr></table></figure><ul><li>推送镜像: <code>docker push</code> 镜像</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker push registry.cn-hangzhou.aliyuncs.com/sessionboy/sinn:v1<br></code></pre></td></tr></table></figure><ul><li>搜索镜像: <code>docker search</code> 镜像名</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">docker search node<br></code></pre></td></tr></table></figure><hr><h5 id="容器自启动"><a class="markdownIt-Anchor" href="#容器自启动"></a> 容器自启动</h5><p>  当通过<code>docker</code>运行一些需要长时间运行的服务时, 不可能实时关注服务的运行状态，当发生故障时就需要紧紧进行重启并恢复服务，因此就需要容器支持自启动。想要容器能够自启动, 首先得保证<code>docker</code>可以在机器重启等情况可以顺利重启, 可以通过<code>systemctl</code>程序设置<code>docker</code>自启动。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo systemctl <span class="hljs-built_in">enable</span> docker.service<br>sudo systemctl start  docker.service<br></code></pre></td></tr></table></figure><p>接下来需要设置容器自启动, 主要有两种方式:</p><ul><li>容器创建是设置</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker run -d --restart=always --name 设置容器名 使用的镜像<br></code></pre></td></tr></table></figure><ul><li>容器创建时用<code>update</code>设置</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker update --restart=always 容器ID(或者容器名)<br></code></pre></td></tr></table></figure><blockquote><p>对于<code>--restart</code> 参数:</p><ul><li><code>no</code>:　　　　　　　 // 默认策略,容器退出时不重启容器；</li><li><code>on-failure</code>: 　　 // 在容器非正常退出时（退出状态非0）才重新启动容器</li><li><code>on-failure:3</code> : // 在容器非正常退出时重启容器，最多重启3次；</li><li><code>always</code>: 　　　　 // 无论退出状态是如何，都重启容器；(一般推荐)</li><li><code>unless-stopped</code>: // 在容器退出时总是重启容器，但是不考虑在 <code>Docker</code> 守护进程启动时就已经停止了的容器。</li></ul></blockquote><p><strong>取消自启动</strong>:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo docker update --restart=no &lt;CONTAINER ID&gt;<br></code></pre></td></tr></table></figure><hr><h4 id="添加docker组"><a class="markdownIt-Anchor" href="#添加docker组"></a> 添加docker组</h4><p>  正常情况下安装完<code>docker</code>需要使用<code>root</code>权限执行<code>docker</code>命令, 对于非<code>root</code>用户需要频繁使用<code>sudo</code>, 非常不方便, 采用如下方法使普通用户同样可以执行<code>docker</code>命令。</p><ul><li>创建名为<code>docker</code>的组，如果之前已经有该组就会报错，可以忽略这个错误</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo groupadd docker<br></code></pre></td></tr></table></figure><ul><li>将当前用户加入组<code>docker</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo gpasswd -a <span class="hljs-variable">$&#123;USER&#125;</span> docker<br></code></pre></td></tr></table></figure><ul><li>重启<code>docker</code>服务(生产环境请慎用)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo systemctl restart docker<br></code></pre></td></tr></table></figure><ul><li>添加访问和执行权限</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo <span class="hljs-built_in">chmod</span> a+rw /var/run/docker.sock<br></code></pre></td></tr></table></figure><ul><li>操作完毕，验证一下，现在可以不用带sudo了</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">╭─etcfly@etcfly-pc ~ <br>╰─$ docker images                                                                                      130 ↵<br>REPOSITORY   TAG       IMAGE ID       CREATED        SIZE<br>ubuntu       latest    99284ca6cea0   8 weeks ago    77.8MB<br>ubuntu       18.04     f9a80a55f492   2 months ago   63.2MB<br>emqx/emqx    latest    af931b5ce7e5   4 months ago   381MB<br></code></pre></td></tr></table></figure><hr><h3 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h3><ul><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/ChaoandPeng/article/details/125534055">Docker安装部署,最详细教程</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_57763462/article/details/119875108">什么是Docker虚拟化</a></li><li><a target="_blank" rel="noopener" href="https://www.coonote.com/docker/docker-architecture.html">Docker 架构</a></li><li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/ubuntu-docker-install.html">ubuntu docker安装</a></li><li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_58804301/article/details/123699684">Docker部署nginx集群</a></li><li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/SuoLiweng/articles/16707955.html">docker容器化部署</a></li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E6%90%AD%E5%BB%BA/" class="category-chain-item">基础设施搭建</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E5%8E%9F%E5%88%9B/">#原创</a> <a href="/tags/docker/">#docker</a> <a href="/tags/%E5%AE%B9%E5%99%A8/">#容器</a></div></div><div class="license-box my-3"><div class="license-title"><div>Docker容器基础</div><div>http://example.com/2023/04/09/docker/base-common/213142/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>EtcFly</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年4月9日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2024年3月5日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2023/04/13/linux/env/wsl/214810/" title="使用wsl作为开发环境"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">使用wsl作为开发环境</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2023/04/04/linux/arm/stm32-openocd-gdb/095427/" title="linux下openocd+gdb调试stm32"><span class="hidden-mobile">linux下openocd+gdb调试stm32</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments"><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",(function(){Fluid.utils.createCssLink("https://lib.baomitu.com/waline/2.14.1/waline.min.css"),Fluid.utils.createScript("https://lib.baomitu.com/waline/2.14.1/waline.min.js",(function(){var i=Object.assign({serverURL:"https://etcfly.top:14000/",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://unpkg.com/@waline/emojis@1.1.0/qq"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10},{el:"#waline",path:window.location.pathname});Waline.init(i),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var i="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://github.com/EtcFly" target="_blank" rel="nofollow noopener"><span>Copyright</span></a> <i class="iconfont icon-copyright"></i> <a href="https://etcfly.top:14100/share/yqTLFDlP/%E4%BB%97%E5%89%91%E8%B5%B0%E5%A4%A9%E6%B6%AF" target="_blank" rel="nofollow noopener"><span>2018-2024 EtcFly</span></a><div style="font-size:.85rem"><span>总访问量 <span style="color:#000" id="PVstatic">0</span> 次&nbsp</span> <span>总访客数 <span style="color:#000" id="UVstatic">0</span> 人&nbsp</span> <span>当前在线 <span style="color:#000" id="ACTstatic">0</span> 人&nbsp</span><script src="https://etcfly.top:14200/statistics" defer></script></div><div style="font-size:.85rem"><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script src="js/duration.js"></script></div></div><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener"></a> </span><span><a href="http://beian.miit.gov.cn/2023000858" rel="nofollow noopener" class="beian-police" target="_blank"><span style="visibility:hidden;width:0">|</span> <img src="/img/police_beian.png" alt="police-icon"> <span>浙ICP备2023000858号</span></a></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var o=jQuery("#board-ctn").offset().top;window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-o}),t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),n=[];for(var i of o)n.push(".markdown-body > "+i.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="/js/jquery.min.js"></script><script src="/live2d-widget/autoload.js"></script><script src="/js/star.js"></script><script src="/js/ribbon.min.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>